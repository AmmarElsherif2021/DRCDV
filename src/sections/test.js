import { Message } from '../db/models/message.js'
import { Buffer } from 'buffer'
import * as XLSX from 'xlsx'

/**
 * Creates a new message with processed attachments
 * @param {string} userId - The ID of the message sender
 * @param {string} channelId - The ID of the channel
 * @param {Object} params - Message parameters
 * @returns {Promise<Message>} Created message
 */

/**
 * Processes Excel attachments with improved error handling
 * @param {Object} attachment - The attachment object
 * @returns {Object} Processed attachment with chart data
 */

/**
 * Formats a message with processed attachments
 * @param {Object} message - The message to format
 * @returns {Object} Formatted message
 */
